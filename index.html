      localStorage.setItem(REF_COUNT_KEY, refCount);
      refCountEl.textContent = refCount;
      let reward = 0.01;
      balance += reward;
      localStorage.setItem(BALANCE_KEY, balance);
      updateBalanceUI();
      updateRefLeaderboard("You", refCount);
      alert("+0.01 Nova for referral!");
    };

    // Leaderboard (local)
    function updateMinerLeaderboard(name, bal) {
      let lb = JSON.parse(localStorage.getItem(MINERS_LEADERBOARD_KEY) || "[]");
      lb = lb.filter(item => item.name !== name);
      lb.push({ name, bal });
      lb.sort((a, b) => b.bal - a.bal);
      lb = lb.slice(0, 10);
      localStorage.setItem(MINERS_LEADERBOARD_KEY, JSON.stringify(lb));
      renderLeaderboardList("minersList", lb, "bal", "Nova");
    }
    function updateRefLeaderboard(name, ref) {
      let lb = JSON.parse(localStorage.getItem(REFERRAL_LEADERBOARD_KEY) || "[]");
      lb = lb.filter(item => item.name !== name);
      lb.push({ name, ref });
      lb.sort((a, b) => b.ref - a.ref);
      lb = lb.slice(0, 10);
      localStorage.setItem(REFERRAL_LEADERBOARD_KEY, JSON.stringify(lb));
      renderLeaderboardList("referrersList", lb, "ref", "refs");
    }
    function renderLeaderboardList(id, lb, key, label) {
      let ul = document.getElementById(id);
      ul.innerHTML = "";
      if (lb.length === 0) {
        ul.innerHTML = "<li>No data yet.</li>";
        return;
      }
      lb.forEach((item, i) => {
        let li = document.createElement('li');
        li.textContent = `${i+1}. ${item.name}`;
        let span = document.createElement('span');
        span.textContent = `${item[key].toFixed ? item[key].toFixed(3) : item[key]} ${label}`;
        li.appendChild(span);
        ul.appendChild(li);
      });
    }
    // Initial leaderboard draw
    renderLeaderboardList("minersList", JSON.parse(localStorage.getItem(MINERS_LEADERBOARD_KEY) || "[]"), "bal", "Nova");
    renderLeaderboardList("referrersList", JSON.parse(localStorage.getItem(REFERRAL_LEADERBOARD_KEY) || "[]"), "ref", "refs");
  </script>
</body>
</html>
